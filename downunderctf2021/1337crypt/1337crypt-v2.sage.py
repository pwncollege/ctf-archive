#!/usr/bin/exec-suid -- /usr/bin/python3

# This file was *autogenerated* from the file 1337crypt-v2.sage
from sage.all_cmdline import *   # import sage library

_sage_const_1337 = Integer(1337); _sage_const_2 = Integer(2); _sage_const_1 = Integer(1); _sage_const_337 = Integer(337); _sage_const_3 = Integer(3); _sage_const_7 = Integer(7); _sage_const_0x1337 = Integer(0x1337)
from Crypto.Util.number import getPrime, bytes_to_long

flag = open('/flag', 'rb').read().strip()

p, q = getPrime(_sage_const_1337 ), getPrime(_sage_const_1337 )
n = p*q

K = NumberField((x-p)**_sage_const_2  + q**_sage_const_2 , names=('z',)); (z,) = K._first_ngens(1)
hint1 = p**_sage_const_2  + q**_sage_const_2 
hint2 = []

l = _sage_const_1 +_sage_const_337 
for _ in range(_sage_const_1 *_sage_const_3 *_sage_const_3 -_sage_const_7 ):
    a, b = getrandbits(_sage_const_1337 ), getrandbits(_sage_const_1337 )
    x = K(a + getrandbits(l)/_sage_const_2 **l) + K(b + getrandbits(l)/_sage_const_2 **l)*z
    y = x*x.conjugate()
    hint2.append((int(y), a, b))

Zn = (ZZ.quo(n*ZZ))['I']; (I,) = Zn._first_ngens(1)
ZnI = Zn.quo(I**_sage_const_2  + _sage_const_1 , names=('I',)); (I,) = ZnI._first_ngens(1)

m = randrange(_sage_const_1 , n) + bytes_to_long(flag) * I
c = pow(m, _sage_const_0x1337 )

print(f'hint1 = {hint1}', f'hint2 = {hint2}', f'c = {c}', sep='\n')

