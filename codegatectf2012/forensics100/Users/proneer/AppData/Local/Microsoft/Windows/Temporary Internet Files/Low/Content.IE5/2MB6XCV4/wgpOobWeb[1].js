var divInstructions,divAlternateMethod,divPleaseWaitContent,divOffline,divOnline,divRefresh,divValidateDisplay,wgpoobwebControl,resultCookie="",downloadTimer;function Validate(){if(!CheckCookie())ShowCookieDisabled();else if(IsWATInstalled()){ShowValidationInProcess();if(undefined!=typeof avs&&null!=avs&&"0"==avs)ValidationCompleted(null,null,null);else{if(wgpoobwebControl.addEventListener){var command='wgpoobwebControl.addEventListener("OnGenuineValidationCompleted", ValidationCompleted, false);';setTimeout(command,WATDelay)}else wgpoobwebControl.attachEvent("OnGenuineValidationCompleted",ValidationCompleted);setTimeout("wgpoobwebControl.BeginGenuineValidation();",WATDelay)}}else document.location.href=WATDownloadPage}function IsWATInstalled(){var installed=false;wgpoobwebControl=GetControl(wgpoobwebControl,"wgpoobwebControl");if(null!=wgpoobwebControl&&typeof wgpoobwebControl.BeginGenuineValidation!="undefined")installed=true;if(isMozilla&&navigator.plugins){navigator.plugins.refresh(false);var mimeType=navigator.mimeTypes[WATMimeType];if(typeof mimeType!="undefined"){wgpoobwebControl=$("wgpoobwebPlugin");installed=true}}return installed}function ValidationCompleted(blob,hrOnlineValue,hrOfflineValue){var wgpOobWebCookieValue="";if(hrOnlineValue==null)hrOnlineValue="";if(hrOfflineValue==null)hrOfflineValue="";if(typeof genuineTicketKey!="undefined"){var genuineTicket=$(genuineTicketKey);if(null!=genuineTicket)genuineTicket.value=blob}if(typeof hrOnlineKey!="undefined"){wgpOobWebCookieValue+=hrOnlineKey+"="+hrOnlineValue;var hrOnline=$(hrOnlineKey);if(null!=hrOnline)hrOnline.value=hrOnlineValue}else wgpOobWebCookieValue+="hrOnline="+hrOnlineValue;if(typeof hrOfflineKey!="undefined"){wgpOobWebCookieValue+="&"+hrOfflineKey+"="+hrOfflineValue;var hrOffline=$(hrOfflineKey);if(null!=hrOffline)hrOffline.value=hrOfflineValue}else wgpOobWebCookieValue+="&hrOffline="+hrOfflineValue;if(null!=wgpoobwebControl&&typeof wgpoobwebControl.GetParameter!="undefined"){var edition=GetEdition();if(null!=formParams)for(i=0;i<formParams.length;i++){var resultField=$(formParams[i]);if(null!=resultField)if(formParams[i]=="OSVersion"&&typeof testOSVersion!="undefined"&&testOSVersion!="")resultField.value=testOSVersion;else if(formParams[i]=="EditionId")resultField.value=edition;else if(formParams[i]=="UserEditionId")if(jQuery.trim(edition)=="")resultField.value="UnknownWin7Edition";else resultField.value=edition;else try{resultField.value=wgpoobwebControl.GetParameter(formParams[i])}catch(err){}}if(null!=cookieParams){for(i=0;i<cookieParams.length;i++){wgpOobWebCookieValue+="&";if(cookieParams[i]=="OSVersion"&&typeof testOSVersion!="undefined"&&testOSVersion!="")wgpOobWebCookieValue+=cookieParams[i]+"="+testOSVersion;else if(cookieParams[i]=="EditionId")wgpOobWebCookieValue+=cookieParams[i]+"="+edition;else if(cookieParams[i]=="UserEditionId")if(jQuery.trim(edition)=="")wgpOobWebCookieValue+=cookieParams[i]+"="+"UnknownWin7Edition";else wgpOobWebCookieValue+=cookieParams[i]+"="+edition;else wgpOobWebCookieValue+=cookieParams[i]+"="+wgpoobwebControl.GetParameter(cookieParams[i])}if(""!=wgpOobWebCookieValue)document.cookie=wgpOobWebCookieName+"="+wgpOobWebCookieValue+"; path="+vRoot}}jQuery("#offlineValidation").hide();jQuery("#onlineValidation").show();var validationForm=$("aspnetForm");if(null!=validationForm){ClearViewstate();validationForm.action=validationUrl;validationForm.target="";validationForm.submit()}}function GetEdition(){var osVersion=wgpoobwebControl.GetParameter("OSVersion"),editionText="UnknownWin7Edition";if(osVersion.length<=27){var editionKey=osVersion.substring(24,27),lcid=wgpoobwebControl.GetParameter("ProductLCID"),edition=editionsObject[editionKey];if(null!=edition)if(lcid=="1042")editionText=editionsObject[editionKey].kEdition;else editionText=editionsObject[editionKey].type}else editionText=wgpoobwebControl.GetParameter("EditionId");return editionText}function CheckCookie(){SetCookie("TestCookie","TestValue");return CookieCheck("TestCookie","TestValue")}function GetControl(obj,id){if(null==obj)return $(id);return obj}function SetVisibility(obj,value){if(null!=obj&&typeof obj.style!="undefined"&&typeof obj.style.display!="undefined")obj.style.visibility=value}function DownloadMsi(){if(typeof installerUrl!="undefined"&&null!=installerUrl)document.location.href=installerUrl}function IsControlPreInstalled(){if(IsWATInstalled())GoToPageHref(returnUrl)}function ControlInstallCheck(){if(!isMozilla){var controlInstaller=GetControl(null,"controlInstaller");wgpoobwebControl=$("wgpoobwebControl");if(null!=wgpoobwebControl){controlInstaller.removeChild(wgpoobwebControl);wgpoobwebControl=null}if(typeof WATClassId!="undefined")controlInstaller.innerHTML='<object classid="clsid:'+WATClassId+'" id="wgpoobwebControl" width="1" height="1"> </object>'}else navigator.plugins.refresh(false);if(IsWATInstalled())GoToPageHref(returnUrl);else DisplayWaitAndContinueMessage()}function ContinueValidation(){var continueButton=$("continue");if(continueButton.className=="button validate")ControlInstallCheck()}function EnableContinue(){var continueButton=$("continue");continueButton.className="button validate"}function DisplayWaitAndContinueMessage(){var continueButton=$("waitAndContinue");SetVisibility(continueButton,"visible")}function pingOmnitureWithProp(propNumber,propValue){}