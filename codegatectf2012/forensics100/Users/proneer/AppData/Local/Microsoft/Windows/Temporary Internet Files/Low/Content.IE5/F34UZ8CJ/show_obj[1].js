var _advert_area='';var has_area=false;var _window_location='';function relation_obj(id,type,big_class,area,advert,ps,codeurl,urlgrep,small_cls,url_c,statistics,os,browser){this.type=type;this.big_class=big_class;this.area=area;this.child=new Array();this.relation_id=id;this.advert=advert;this.position_id=ps;this.codeurl=codeurl;this.urlgrep=urlgrep;this.small_class=small_cls;this.url_c=url_c;this.is_statistics=statistics;this.os=os;this.browser=browser;}function advert_obj(id,type,file,content,width,height,url){this.type=type;this.file=file;this.ad_id=id;this.content=content;this.width=width;this.height=height;this.url=url;}function if_get_area_fun(obj){switch(obj.type){case 1:var c_arr=obj.big_class.split('@');if( _main_name==c_arr[1]){return 1;}else{return 2;}break;case 2:var c_arr=obj.big_class.split('@');if(_main_name==c_arr[1] && _sub_name==obj.small_class){return 1;}else{return 2;}break;case 3:if(!has_area){ad_AJAXRequest('/?act=getArea',function(text){_advert_area=text;has_area=true;},false);}return 2;break;default:return 1;break;}}function check_check_get_area(arr){if(has_area) return ;for(var i in arr){if(has_area) return ;var flag=if_get_area_fun(arr[i]);if(flag==1) {if(arr[i]['child']!='' && arr[i]['child']!=null  && arr[i]['child'].length>0){check_check_get_area(arr[i]['child']);}}else{}}}function check_relation(obj){switch(obj.type){case 0:return true;break;case 1:var c_arr=obj.big_class.split('@');if( _main_name==c_arr[1]){return true;}else{return false;}break;case 2:var c_arr=obj.big_class.split('@');if(  _sub_name==obj.small_class){return true;}else{return false;}break;case 3:if(obj.area.indexOf('|!|')<0){if(obj.area.indexOf('|'+_advert_area+'|')<0){return false;}else{return true;}}else{if(obj.area.indexOf('|'+_advert_area+'|')<0){return true;}else{return false;}}break;case 4:return true;break;case 5:return true;break;case 6:var os=check_evn(obj.os);var browser=check_evn(obj.browser);if(os && browser) {return true;}else{return false;}break;case 100:if(_window_location.indexOf(obj.urlgrep)>=0) return true;else return false;break;}}function check_evn(str){var env=navigator.userAgent.toLowerCase();if(str!=''){var chk_str=str;if(chk_str.indexOf('|!|')<0){chk_str=chk_str.toLowerCase();var oslist=chk_str.split('|');for(var os in oslist){if(oslist[os]!=''){if(env.indexOf(oslist[os])>=0) return true;}}return false;}else{chk_str=chk_str.replace('|!|','').toLowerCase();var oslist=chk_str.split('|');for(var os in oslist){if(oslist[os]!=''){if(env.indexOf(oslist[os])>=0) return false;}}return true;}}else{return true;}}function check_relation_child(arr,depth,id){if(!isNaN(eval("result_found_"+id+"["+depth+"]"))) return;var l=arr.length;for(var i=0;i<l;i++){if(!isNaN(eval("result_found_"+id+"["+depth+"]"))) return;if(arr[i]){if(check_relation(arr[i])) {eval("result_found_"+id+"["+depth+"]="+i);if(arr[i]['child']!='' && arr[i]['child']!=null  && arr[i]['child'].length>0){check_relation_child(arr[i]['child'],depth+1,id);}else{}}}}}function ad_put_content_html(obj,url_c){switch(obj.type){case 'text':var s=obj.content.replace(/@url_c/g,url_c);return replace_sys_str(s);break;case 'img':var advert_str="<a href=\"http://g.brothersoft.com/c.php?u="+url_c+"&a="+obj.ad_id+"&url="+obj.url+"\"  target=\"_blank\" rel=\"nofollow\"><img src=\""+obj.file+"\" width=\""+obj.width+"\" height=\""+obj.height+"\" border=\"0\" /></a>";return advert_str;break;case 'flash':var link_url=obj.file;if(obj.url!='') link_url+="?clickTAG="+escape("http://g.brothersoft.com/c.php?u="+url_c+"&a="+obj.ad_id+"&url="+obj.url);var advert_str='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,29,0" width="'+obj.width+'" height="'+obj.height+'"> <param name="movie" value="'+link_url+'"><param name="wmode" value="opaque" /><param name="quality" value="high"> <embed src="'+link_url+'" wmode="opaque" quality="high" pluginspage="http://www.macromedia.com/go/getflashplayer" type="application/x-shockwave-flash" width="'+obj.width+'" height="'+obj.height+'"></embed></object>';return advert_str;}}function ad_AJAXRequest(url,callback,asyn){var ff=false;var xmlObj;try { xmlObj=new XMLHttpRequest; ff=true}catch(e) {try { xmlObj=new ActiveXObject("MSXML2.XMLHTTP"); }catch(e2) {try { xmlObj=new ActiveXObject("Microsoft.XMLHTTP"); }catch(e3) { xmlObj=false; }}}xmlObj.open("GET",url,asyn);if(asyn==false && ff==true){xmlObj.send(null);callback(xmlObj.responseText);}else{xmlObj.onreadystatechange=function(){if(xmlObj.readyState==4 && xmlObj.status==200){callback(xmlObj.responseText);}};xmlObj.send(null);}}function ad_judge_advert(objs,ads,ps){var advert_arr=new Array();for(var i in objs.advert){if(ads[objs.advert[i]])advert_arr[advert_arr.length]=ads[objs.advert[i]];}if(objs.codeurl!='' && objs.codeurl!=null){document.write("<script src=\""+objs.codeurl+"\"><\/script>");if(parseInt(objs.is_statistics)==1)create_impr_js(ps,objs.relation_id,0);return ;}switch(objs.type){case 4:var rand=advert_arr.length>1?Math.round(Math.random()*(advert_arr.length)):0;rand=(rand>=advert_arr.length)?advert_arr.length-1:rand;if(parseInt(objs.is_statistics)==1)create_impr_js(ps,objs.relation_id,advert_arr[rand].ad_id);document.write(ad_put_content_html(advert_arr[rand],objs.url_c));break;case 5:document.write("<div id=\"advert_div_"+objs.position_id+"\"></div>");if(advert_arr.length<2){document.write(ad_put_content_html(advert_arr[0],objs.url_c));return ;}var url= "/?act=loop_show&ps="+objs.position_id+"&rl="+objs.relation_id+'&l='+advert_arr.length+'&'+(new Date).getTime();ad_AJAXRequest(url,function(text){document.write(ad_put_content_html(advert_arr[text],objs.url_c));if(parseInt(objs.is_statistics)==1) create_impr_js(ps,objs.relation_id,advert_arr[text].ad_id);},false);return '';break;default:document.write(ad_put_content_html(advert_arr[0],objs.url_c));if(parseInt(objs.is_statistics)==1) create_impr_js(ps,objs.relation_id,advert_arr[0].ad_id);break;}}function create_impr_js(ps,r,a){var js_obj=document.createElement('script');js_obj.src="http://ga.brothersoft.com/a.js?p="+ps+"&r="+r+"&a="+a;document.body.appendChild(js_obj);}function QueryString(){var name,value,i;var str=location.href;var num=str.indexOf("?");str=str.substr(num+1);var arrtmp=str.split("&");for(i=0;i < arrtmp.length;i++){num=arrtmp[i].indexOf("=");if(num>0){name=arrtmp[i].substring(0,num);value=arrtmp[i].substr(num+1);this[name]=value;}}}function replace_sys_str(str){var time_rand=(new Date()).getTime()+'.'+Math.random()*1000;var s=str.replace(new RegExp('....time_rand....',"gm"),time_rand);return s;}