String.prototype.beginsWith=function(t,i){if(i==false)return t==this.substring(0,t.length);else return t.toLowerCase()==this.substring(0,t.length).toLowerCase()};String.prototype.endsWith=function(t,i){if(i==false)return t==this.substring(this.length-t.length);else return t.toLowerCase()==this.substring(this.length-t.length).toLowerCase()};function GoToHttpHref(pageName){if(pageName.indexOf("AddParams")!=-1)pageName=pageName.replace("AddParams",params).replace("?","");var nextLocation=location.href.replace("https","http");nextLocation=nextLocation.slice(0,nextLocation.indexOf(vRoot));location.href=nextLocation+vRoot+"/"+pageName}function PostToCR(buttonURL,product){var errorPage="",controlPage="";if(product=="vista"){controlPage="downloads/Validate.aspx"+params+"&Page=VistaQualifyInfo";errorPage="vista/PurchaseError.aspx"+params+"&msg=60"}else{controlPage="purchase/BrowserAlternative.aspx"+params+"&page=validate";errorPage="purchase/PurchaseError.aspx"+params+"&msg=40"}var details=$("genuineMachineDetail");if(details==null)GoToPageHref(errorPage+"2");else if(navigator.appName.indexOf("Microsoft")==-1&&navigator.appName.indexOf("Netscape")==-1)GoToPageHref("purchase/BrowserAlternative.aspx"+params+"&page=validate");else if(details.value=="")GoToPageHref(controlPage);else{var decodedDetails=HtmlDecode(details.value),osNumber=getXmlVal("OS",decodedDetails);if(null!=osNumber&&osNumber.length>0){var details=osNumber.split("."),osType=details[7];if(product=="vista"&&details[0]!="6"||product!="vista"&&!(osType=="hom"||osType=="pro"||osType=="xhk"||osType=="xhn"||osType=="hkn"||osType=="xpk"||osType=="xpn"||osType=="pkn"))GoToPageHref(errorPage+"3");else{var detail=$("genuineMachineDetail");if(detail.value.indexOf("&gt;")<0)detail.value=HtmlEncode(detail.value);var url=window.location.href,bookmark="";if(url.indexOf("#")>-1)bookmark=url.substr(url.indexOf("#"));ClearViewstate();var webForm=$("aspnetForm");webForm.action=buttonURL+bookmark;webForm.submit()}}else GoToPageHref(errorPage+"3")}}function GoToPageHref(pageName,newWindow){if(pageName.indexOf("AddParams")!=-1)pageName=pageName.replace("AddParams",params).replace("?","");if(newWindow)window.open(vRoot+"/"+pageName);else location.href=vRoot+"/"+pageName}function GoToPageReplace(pageName){location.replace(vRoot+"/"+pageName)}function nonGenuineToggleMessage(){toggleMessage()}function toggleMessage(){var expandImage=$("detailsImage"),messageDetails=$("failureMessage"),detailsLink=$("showDetailsLink");if(messageDetails.style.display=="none"){messageDetails.style.display="block";expandImage.src=expandImage.src.replace("expand","collapse");expandImage.alt=collapseText;detailsLink.innerHTML=collapseText}else{messageDetails.style.display="none";expandImage.src=expandImage.src.replace("collapse","expand");expandImage.alt=expandText;detailsLink.innerHTML=expandText}}function buttonMouseOver(image){image.src=image.src.replace("normal","hover");image.style.cursor="pointer"}function buttonMouseOut(image){image.src=image.src.replace("hover","normal");image.style.cursor="default"}function ToggleOption(optionNum){var image=$("opt_"+optionNum+"_image"),description=$("opt_"+optionNum+"_expand");if(description.style.display=="none"){description.style.display="block";image.src=image.src.replace("closed","open");image.alt=collapseText}else{description.style.display="none";image.src=image.src.replace("open","closed");image.alt=expandText}UpdateExpansions()}function AddHiddenInputToForm(f,n,v){var el=document.createElement("INPUT");el.type="HIDDEN";el.name=n;el.id=n;el.value=v;f.appendChild(el)}function expandMouseOver(object){object.style.cursor="pointer"}function expandMouseOut(object){object.style.cursor="default"}function AllowEkeys(errorParam){if(errorParam=="1"||errorParam=="3"||errorParam=="8"||errorParam=="9"||errorParam=="11"||errorParam=="13")return true;else return false}function OpenWindow(popupUrl,popupHeight,popupWidth){try{if(popupHeight==null)popupHeight=415;if(popupWidth==null)popupWidth=610;self.name="genuineMain";var popupWindow=window.open(vRoot+"/"+popupUrl,null,"width="+popupWidth+",height="+popupHeight+",scrollbars=yes,resizable=yes");popupWindow.focus()}catch(ex){}}function LegitCheckOnLoad(paramsToAdd){var delimiter="&",lastErrorDiagnostic,sresult="-100";try{sresult=LegitCheck.LegitCheck()}catch(ex){try{lastErrorDiagnostic=LegitCheck.GetLastErrors();if(lastErrorDiagnostic!=""){paramsToAdd=paramsToAdd+"&diag="+lastErrorDiagnostic;if(pageName!="Offers")GoToPageHref("downloads/default.aspx"+paramsToAdd+"&LegitCheckError=-100")}else if(pageName!="Offers")GoToPageHref("downloads/default.aspx"+paramsToAdd+"&LegitCheckError=-100")}catch(ex2){if(pageName!="Offers")GoToPageHref("downloads/default.aspx"+paramsToAdd+"&LegitCheckError=-100")}}var result=Number(sresult);if(lastErrorDiagnostic=="")try{lastErrorDiagnostic=LegitCheck.GetLastErrors()}catch(ex3){lastErrorDiagnostic=""}if(lastErrorDiagnostic!="")paramsToAdd=paramsToAdd+"&diag="+lastErrorDiagnostic;if(result==0){if(pageName!="SuccessfulActivation"&&pageName!="Offers")GoToPageHref("downloads/SuccessfulActivation.aspx"+paramsToAdd)}else if(result>=1&&result<=13||result==90||result==99)GoToPageHref("downloads/default.aspx"+paramsToAdd+"&LegitCheckError="+result);else if(pageName!="Offers")GoToPageHref("downloads/default.aspx"+paramsToAdd+"&LegitCheckError=-100");return result}function LegitCheckOnLoadOGA(paramsToAdd){var delimiter="&",lastErrorDiagnostic,sresult="-100";try{sresult=LegitCheck.LegitCheck()}catch(ex){try{lastErrorDiagnostic=LegitCheck.GetLastErrors();if(lastErrorDiagnostic!=""){paramsToAdd=paramsToAdd+"&diag="+lastErrorDiagnostic;if(pageName!="Offers")GoToPageHref("downloads/default.aspx"+paramsToAdd+"&LegitCheckError=-100")}else if(pageName!="Offers")GoToPageHref("downloads/default.aspx"+paramsToAdd+"&LegitCheckError=-100")}catch(ex2){if(pageName!="Offers")GoToPageHref("downloads/default.aspx"+paramsToAdd+"&LegitCheckError=-100")}}var result=Number(sresult);if(lastErrorDiagnostic=="")try{lastErrorDiagnostic=LegitCheck.GetLastErrors()}catch(ex3){lastErrorDiagnostic=""}if(lastErrorDiagnostic!="")paramsToAdd=paramsToAdd+"&diag="+lastErrorDiagnostic;if(result==0){if(pageName!="SuccessfulActivation"&&pageName!="Offers")GoToPageHref("downloads/SuccessfulActivation.aspx"+paramsToAdd)}else if(result>=1&&result<=13||result==90||result==99)GoToPageHref("downloads/default.aspx"+paramsToAdd+"&LegitCheckError="+result);else if(pageName!="Offers")GoToPageHref("downloads/default.aspx"+paramsToAdd+"&LegitCheckError=-100");return result}function LTrim(InString){OutString=InString;for(Count=0;Count<InString.length;Count++){TempChar=InString.substring(Count,Count+1);if(TempChar!=" "){OutString=InString.substring(Count,InString.length);break}}return OutString}function RTrim(argvalue){while(1){if(argvalue.substring(argvalue.length-1,argvalue.length)!=" ")break;argvalue=argvalue.substring(0,argvalue.length-1)}return argvalue}function RemoveLBreaks(InString){OutString=InString;for(Count=0;Count<InString.length;Count++){TempChar=InString.substring(Count,Count+1);if(TempChar!="\r"&&TempChar!="\n"){OutString=InString.substring(Count,InString.length);break}}return OutString}function CheckMaxLength(thisField,maxlength){if(thisField.value.length>=maxlength)event.returnValue=false}function CleanInput(input){return input.replace(/</g,"").replace(/>/g,"").replace(/&#/g,"")}function RemoveRBreaks(InString){while(1){if(InString.substring(InString.length-1,InString.length)!="\r"&&InString.substring(InString.length-1,InString.length)!="\n")break;InString=InString.substring(0,InString.length-1)}return InString}function translate_errnum(num){var msg=""+num.toString(16).toUpperCase();while(msg.length<6)msg="0"+msg;return "0x80"+msg}function changeImageSet(){var changeThisButton=document.getElementById("togglebutton");if(changeThisButton.alt=="Expand"){changeThisButton.alt="Collapse";changeThisButton.src=vRoot+"/static/images/collapse.jpg"}else{changeThisButton.alt="Expand";changeThisButton.src=vRoot+"/static/images/expand.jpg"}}function invertOnMouseOver(){var changeThisButton=document.getElementById("togglebutton");if(changeThisButton.alt=="Expand")changeThisButton.src="../static/images/expand.jpg";else changeThisButton.src="../static/images/collapse.jpg"}function revertOnMouseOut(){var changeThisButton=document.getElementById("togglebutton");if(changeThisButton.alt=="Expand")changeThisButton.src="../static/images/expand.jpg";else changeThisButton.src="../static/images/collapse.jpg"}function pingOmniture(prop10Value,urlToRedirect,formName){}function Machine(legitcontrol){this.os="";this.sysPKey="";this.pid="";this.sysMod="";this.sysMan="";this.legitcontrol=legitcontrol;this.getMachineDetails()}function getMachineDetails(){with(this){var machineInfo;try{machineInfo=legitcontrol.GetMachineDetails()}catch(e){}if(machineInfo!=""){sysPKey=getXmlVal("PKey",machineInfo);sysPid=getXmlVal("PID",machineInfo);var sysSid=getXmlVal("SID",machineInfo);sysMod=getXmlVal("SYSTEM/Model",machineInfo);sysMan=getXmlVal("SYSTEM/Manufacturer",machineInfo);var osNumber=getXmlVal("OS",machineInfo),details=osNumber.split("."),osMajor=details[0],osMinor=details[1],osBuild=details[2],osSPmaj=details[5],osSPmin=details[6],osType=details[7];if(osMajor=="5"&&osMinor=="1"){os="Windows XP";if(osType=="tab")os=os+" Tablet PC Edition";else if(osType=="med")os=os+" Media Center Edition";else if(osType=="sta")os=os+" Starter Edition";else if(osType=="pro")os=os+" Professional";else os=os+" Home"}else if(osMajor=="5"&&osMinor=="2")os="Windows Server 2003";else if(osMajor=="5"&&osMinor=="0")os="Windows 2000";else if(osMajor=="6"&&osMinor=="0")os="Windows Vista";if(osSPmaj!=0)os=os+", Service Pack "+osSPmaj}}}Machine.prototype.getMachineDetails=getMachineDetails;function $(elementId){if(document.getElementById(elementId))return document.getElementById(elementId);else if(document.getElementById(masterID+elementId))return document.getElementById(masterID+elementId);else if(document.getElementById(otherFormID+elementId))return document.getElementById(otherFormID+elementId)}function trim(stringToTrim){return stringToTrim.replace(/^\s+|\s+$/g,"")}function ReadCookie(name){var nameEQ=name+"=",cookies=document.cookie.split(";");for(var count=0;count<cookies.length;count++){var cookie=cookies[count];while(cookie.charAt(0)==" ")cookie=cookie.substring(1,cookie.length);if(cookie.indexOf(nameEQ)==0)return cookie.substring(nameEQ.length,cookie.length)}return null}function SetCookie(name,value){document.cookie=name+"="+escape(value)}function GetCookieCount(product){var cookieValue=ReadCookie(countCookieName);if(cookieValue!=null){cookieValue=trim(cookieValue);if(cookieValue.length!=0){var index=cookieValue.indexOf(product);if(index!=-1)return cookieValue.substring(index+4,index+5)}}return "-1"}function SubmitAspNetForm(nextPage){var webForm=$("aspnetForm");webForm.action=nextPage;webForm.submit()}function addField(name,value){var newfield=btpField.cloneNode(true);newfield.name=name;newfield.value=value;var form1=document.getElementById("omform");form1.insertBefore(newfield,btpField)}function createAsynHttpRequest(){try{request=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{request=new ActiveXObject("Microsoft.XMLHTTP")}catch(oc){request=null}}if(!request&&typeof XMLHttpRequest!="undefined")request=new XMLHttpRequest;return request}function HtmlDecode(text){while(text.indexOf("&gt;")>0)text=text.replace("&gt;",">").replace("&lt;","<");return text}function CookieCheck(name,value){return document.cookie.search(name+"="+value)>=0}function ShowCalendar(e,server,vRoot,displaylang){var posx=0,posy=0;if(!e)var e=window.event||window.Event;if(e.clientX||e.clientY){posx=e.clientX;posy=e.clientY}if(IsRtl)calendar_window=window.open(server+vRoot+"/common/datepicker.aspx?ctrlId=btnCal&displaylang="+displaylang,"calendar_window","width=325,height=170,status=no,toolbar=no,titlebar=no,left="+(posx-500)+",top="+posy);else calendar_window=window.open(server+vRoot+"/common/datepicker.aspx?ctrlId=btnCal&displaylang="+displaylang,"calendar_window","width=325,height=170,status=no,toolbar=no,titlebar=no,left="+(posx+125)+",top="+posy);calendar_window.focus()}function VersionDiff(ver1,ver2){if(ver1==ver2)return 0;if(ver1==null||ver2==null)return ver1==null?-1:1;var v1=ver1.split("."),v2=ver2.split("."),len=v1.length;if(v2.length<len)len=v2.length;for(var i=0;i<len;i++){if(v1[i]<v2[i])return -1;if(v2[i]<v1[i])return 1}if(v2.length!=v1.length)return v1.length<v2.length?-1:1;return 0}function toggleButton(buttonID,URL,className){if($(buttonID).className=="button disabled")enableButton(buttonID,URL,className);else disableButton(buttonID)}function enableButton(buttonID,URL,className){$(buttonID).href=URL;$(buttonID).className=className}function disableButton(buttonID){$(buttonID).href="javascript:void(0)";$(buttonID).className="button disabled"}var btn={init:function(){if(!document.getElementById||!document.createElement||!document.appendChild)return false;var as=btn.getAllButtons(),btnReg=/(^|\s)button(\s|$)/;for(i=0;i<as.length;i++){if(as[i].type.toLowerCase()=="submit"||as[i].type.toLowerCase()=="button"){var a1=document.createElement("a");a1.appendChild(document.createTextNode(as[i].value));a1.className=as[i].className;if(as[i].getAttribute("href"))a1.href=as[i].getAttribute("href");if(as[i].getAttribute("onclick"))a1.setAttribute("onclick",as[i].getAttribute("onclick"));else if(as[i].type.toLowerCase()=="submit"){var form=btn.findForm(as[i]);btn.addEvent(a1,"click",function(){form.submit()})}if(as[i].getAttribute("target"))a1.target=as[i].getAttribute("target");if(!btnReg.test(a1.className))a1.className+=" button";a1.id=as[i].id;as[i]=as[i].parentNode.replaceChild(a1,as[i]);as[i]=a1;as[i].style.cursor="pointer"}else continue;var i1=document.createElement("i"),i2=document.createElement("i"),s1=document.createElement("span"),s2=document.createElement("span");s1.appendChild(i1);s1.appendChild(s2);while(as[i].firstChild)s1.appendChild(as[i].firstChild);as[i].appendChild(s1);var nextSibling=as[i].nextSibling;as[i]=as[i].insertBefore(i2,s1)}},findForm:function(f){while(f&&f.tagName!="FORM")f=f.parentNode;return f},addEvent:function(obj,type,fn){if(obj)if(obj.addEventListener)obj.addEventListener(type,fn,false);else if(obj.attachEvent){obj["e"+type+fn]=fn;obj[type+fn]=function(){obj["e"+type+fn](window.event)};obj.attachEvent("on"+type,obj[type+fn])}},getAllButtons:function(){var allInputs=$("genuine").getElementsByTagName("input"),returnElements=[],current,length=allInputs.length;for(var i=0;i<length;i++)if(allInputs[i].type.toLowerCase()=="submit"||allInputs[i].type.toLowerCase()=="button"){current=allInputs[i];returnElements.push(current)}return returnElements},disable:function(objOrId){var oBtn;if(typeof objOrId=="string"&&objOrId.constructor==String)oBtn=$(objOrId);else oBtn=objOrId;if(oBtn){oBtn.onclick=function(){return false};oBtn.className="button disabled"}},enable:function(objOrId,className,action,href,target,isSeverControl){var oBtn;if(typeof objOrId=="string"&&objOrId.constructor==String)oBtn=$(objOrId);else oBtn=objOrId;if(oBtn){oBtn.className=className||"button validate";if(action)if(isSeverControl)oBtn.onclick=action;else oBtn.onclick=function(){action();return false};else oBtn.onclick=null;if(href)oBtn.href=href;if(target)oBtn.target=target}}};function localSearch(){var searchText=$("searchText");if(null!=searchText&&searchText.value!=""){var searchUrl=vRoot+"/search.aspx"+params;if(params!="")searchUrl+="&search="+escape(searchText.value);location.href=searchUrl}}function executeLocalSearch(e){if(IsEnter(e))localSearch()}function executeLiveSearch(e){if(IsEnter(e)){liveSearch();return false}}function IsEnter(e){var evt=e?e:window.event;if(evt.keyCode==13)return true;return false}function liveSearch(e){var webSearchText=$("webSearchText");if(null!=webSearchText)location.href="http://search.live.com?q="+webSearchText.value}function GoToSection(section){var nav="#"+section,bookMark="";if(location.href.indexOf(nav)==-1)bookMark=nav;location.href=location.href+bookMark}function getElementsByClassName(classname){if(document.getElementsByClassName)return document.getElementsByClassName(classname);else{var retnode=[],myclass=new RegExp("\\b"+classname+"\\b"),elem=document.getElementsByTagName("*");for(var i=0;i<elem.length;i++){var classes=elem[i].className;if(myclass.test(classes))retnode.push(elem[i])}return retnode}}function reconcileStepBoxHeight(){var stepBoxes=getElementsByClassName("stepBox");if(stepBoxes){var longestDim=0,i=0;for(i=0;i<stepBoxes.length;i++){var stepBox=stepBoxes[i];if(stepBox&&longestDim<stepBox.offsetHeight)longestDim=stepBox.offsetHeight}for(i=0;i<stepBoxes.length;i++){var stepBox=stepBoxes[i];if(stepBox)stepBox.style.height=longestDim+"px"}}}function SetBackgroundText(searchBox){if(!searchBox.HasFocus)if(jQuery.trim(searchBox.value)==""||jQuery.trim(searchBox.value)==jQuery.trim(searchBox.title)){searchBox.value=jQuery.trim($("SearchQueryBoxBackgroundLevel1").innerHTML);searchBox.className="SearchQueryTextInput"}if(searchBox.HasFocus)if(jQuery.trim(searchBox.value)==jQuery.trim(searchBox.title)){searchBox.value="";searchBox.className="SearchQueryTextInput2 SearchQueryTextInput"}}function SearchSubmitClick(searchBox){if(jQuery.trim(searchBox.value)==jQuery.trim(searchBox.title))return false;return true}